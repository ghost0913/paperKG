webpackJsonp([1],{"1uuo":function(e,t){},"F+s9":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7+uW"),o={render:function(){var e=this.$createElement;return(this._self._c||e)("router-view")},staticRenderFns:[]};var i=n("VU/8")({name:"App"},o,!1,function(e){n("F+s9")},null,null).exports,a=n("/ocq"),s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[n("h1",[e._v(e._s(e.msg))]),e._v(" "),n("h2",[e._v("Essential Links")]),e._v(" "),e._m(0),e._v(" "),n("h2",[e._v("Ecosystem")]),e._v(" "),e._m(1)])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",[n("li",[n("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[e._v("\n        Core Docs\n      ")])]),e._v(" "),n("li",[n("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[e._v("\n        Forum\n      ")])]),e._v(" "),n("li",[n("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank"}},[e._v("\n        Community Chat\n      ")])]),e._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[e._v("\n        Twitter\n      ")])]),e._v(" "),n("br"),e._v(" "),n("li",[n("a",{attrs:{href:"http://vuejs-templates.github.io/webpack/",target:"_blank"}},[e._v("\n        Docs for This Template\n      ")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("a",{attrs:{href:"http://router.vuejs.org/",target:"_blank"}},[this._v("\n        vue-router\n      ")])]),this._v(" "),t("li",[t("a",{attrs:{href:"http://vuex.vuejs.org/",target:"_blank"}},[this._v("\n        vuex\n      ")])]),this._v(" "),t("li",[t("a",{attrs:{href:"http://vue-loader.vuejs.org/",target:"_blank"}},[this._v("\n        vue-loader\n      ")])]),this._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[this._v("\n        awesome-vue\n      ")])])])}]};n("VU/8")({name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App"}}},s,!1,function(e){n("1uuo")},"data-v-d8ec41bc",null).exports;var l=n("Xxa5"),c=n.n(l),u=n("exGp"),h=n.n(u),p=n("KmDb"),d=n.n(p),f=n("bOdI"),m=n.n(f),g=n("woOf"),v=n.n(g),b=n("Gu7T"),y=n.n(b),w=n("gRE1"),k=n.n(w),C=n("mvHQ"),_=n.n(C),D=n("aO9e"),x=(n("Ml+6"),n("p2T3")),N=(n("JYDK"),n("zL8q")),T=n.n(N),O=n("iQqP");r.default.use(T.a);var E={name:"Canvas",data:function(){return{queryA:"",queryB:"",height:0,width:0,cacheData:[],cacheDetail:{},le:0,Graph:null,driver:null,showMenu:!1,showMenuItem:[{show:!1},{show:!1},{show:!1},{show:!1}],colorList:{institution:"#e84545",person:"#0099CC",monograph:"#FF9900",fund:"#00b8a9",stock:"#6c5b7b",currency:"#b61aae",detail:"#fcfcfc",paper:"#0099CC",conference:"#e84545",title:"#e84545",citation:"#e84545",metric:"#0099CC",listLength:"#00b8a9",baseline:"#EB43D2",paper_baseline:"#fcfcfc"},linkLabelColor:"#999999",linkColor:"#FFFFFF",checkColorType:["person","monograph","institution","detail","paper","conference","metric","listLength","citation","baseline","paper_baseline"],uncolored:"#666666",loading:!0}},mounted:function(){var e=this;this.width=document.body.clientWidth,this.height=document.body.clientHeight,window.addEventListener("resize",function(){e.width=document.body.clientWidth,e.height=document.body.clientHeight,e.Graph.height(e.height).width(e.width)}),this.init3DGraph()},methods:{init3DGraph:function(){var e=this,t=document.getElementById("3d-graph");e.driver=O.driver("bolt://124.221.176.99",O.auth.basic("neo4j","123456"),{encrypted:!1});var n=e.driver.session();if("{}"===_()(e.cacheDetail)){var r=e.driver.session();r.run('MATCH (n)-[r]->(m) WHERE m.type = "detail" RETURN { id: id(n), label: n.name, property: properties(n), degree: size((n)--()) } as source, { id: id(m), label: m.name, property: properties(m), degree: size((m)--()) } as target, type(r) as relation').then(function(t){var n={},o=t.records.map(function(e){var t=e.get("target");t.id=t.id.toNumber(),n[t.id]=t;var r=e.get("source");return r.id=r.id.toNumber(),n[r.id]=r,{source:r.id,target:t.id,type:e.get("relation")}}),i=k()(n);r.close(),e.cacheDetail={nodes:{},links:{}},i.forEach(function(t){t.hasOwnProperty("id")&&(e.cacheDetail.nodes[t.id]=t)}),o.forEach(function(t){e.cacheDetail.links.hasOwnProperty(t.source)?e.cacheDetail.links[t.source].push(t):e.cacheDetail.links[t.source]=[t]})})}n.run('MATCH (n)-[r]->(m) WHERE m.type <> "detail" RETURN { id: id(n), label: n.name, property: properties(n), degree: size((n)--()) } as source, { id: id(m), label: m.name, property: properties(m), degree: size((m)--()) } as target, type(r) as relation').then(function(r){var o={},i=r.records.map(function(e){var t=e.get("source");t.id=t.id.toNumber(),o[t.id]=t;var n=e.get("target");return n.id=n.id.toNumber(),o[n.id]=n,{source:t.id,target:n.id,type:e.get("relation")}});n.close();var a={nodes:k()(o),links:i};if(0===e.cacheData.length)for(var s=0;s<a.nodes.length;s++)e.cacheData.push(a.nodes[s]);e.Graph=Object(D.a)().height(e.height).width(e.width),e.Graph(t).graphData(a).d3VelocityDecay(.75).nodeColor(function(t){return e.colorList[t.property.type]}).nodeLabel(function(e){return"description"in e.property?e.property.description:e.label}).nodeThreeObject(function(t){var n=new x.a(t.label);return n.material.depthWrite=!1,n.color=e.colorList[t.property.type],n.textHeight=e.sizeOnDegree(t),n}).nodeResolution(12).linkThreeObjectExtend(!0).linkThreeObject(function(t){var n=new x.a(""+t.type);return n.color=e.linkLabelColor,n.textHeight=2,n}).linkPositionUpdate(function(e,t){var n=t.start,r=t.end,o=v.a.apply(Object,y()(["x","y","z"].map(function(e){return m()({},e,n[e]+(r[e]-n[e])/2)})));v()(e.position,o)}).linkLabel(function(e){return e.type}).linkColor(e.linkColor).linkOpacity(.3).linkDirectionalParticles(1).linkDirectionalParticleColor(function(){return"red"}).linkDirectionalParticleSpeed(.02).linkDirectionalParticleWidth(1).linkDirectionalParticleResolution(8).onNodeHover(function(e){return t.style.cursor=e?"pointer":null}).onNodeClick(function(t){e.cacheDetail.links.hasOwnProperty(t.id)&&e.cacheDetail.links[t.id].forEach(function(t){var n=e.Graph.graphData(),r=n.nodes,o=n.links,i=e.cacheDetail.nodes[t.target];e.Graph.graphData({nodes:[].concat(y()(r),[i]),links:[].concat(y()(o),[t])})}),e.focusOnNode(t),t.fx=t.x,t.fy=t.y,t.fz=t.z})}).catch(function(e){console.log(e)})},focusOnNode:function(e){var t=1+40/d()(e.x,e.y,e.z);this.Graph.cameraPosition({x:e.x*t,y:e.y*t,z:e.z*t},e,3e3)},sizeOnDegree:function(e){var t=e.degree.toNumber();return t>=5?7:t>=2?5.5:3.5},querySearch:function(e,t){var n=JSON.parse(_()(this.cacheData.map(function(e){return e.property})));n=n.map(function(e){return e.value=e.name,e});var r=e?n.filter(this.createFilter(e)):n;t(JSON.parse(_()(r)))},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},queryForA:function(e){var t=!1;if(0===e.length)this.$message.error("请先输入关键词，再进行节点检索！");else{for(var n=0;n<this.cacheData.length;n++)if(this.cacheData[n].label.toLowerCase()===e.toLowerCase()){this.focusOnNode(this.cacheData[n]),t=!0;break}t?this.showB=!0:this.$message.warning("关系图谱中找不到该节点，请尝试更换搜索关键词！")}},queryForAB:function(){var e=this;return h()(c.a.mark(function t(){var n,r,o,i,a,s,l,u,h,p,d,f;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!1,o=!1,i=!1,0!==(n=e).queryA.length&&0!==n.queryB.length){t.next=9;break}e.$message.error("请先确保输节点A、B均有内容，再进行AB路径检索！"),i=!0,t.next=26;break;case 9:a=0;case 10:if(!(a<e.cacheData.length)){t.next=17;break}if(n.cacheData[a].label.toLowerCase()!==n.queryA.toLowerCase()){t.next=14;break}return r=!0,t.abrupt("break",17);case 14:a++,t.next=10;break;case 17:s=0;case 18:if(!(s<e.cacheData.length)){t.next=25;break}if(n.cacheData[s].label.toLowerCase()!==n.queryB.toLowerCase()){t.next=22;break}return o=!0,t.abrupt("break",25);case 22:s++,t.next=18;break;case 25:r&&o||(e.$message.warning("关系图谱中无该指定节点，请尝试更换搜索节点！"),i=!0);case 26:return l=document.getElementById("3d-graph"),u=[],h=[],p=n.driver.session(),t.next=32,p.run("MATCH p=shortestpath((a{name:'"+n.queryA+"'})-[*..8]-(b{name:'"+n.queryB+"'})) RETURN length(p) as l").then(function(e){e.records.map(function(e){n.le=e.get("l").toNumber()}),n.le+=1}).catch(function(e){return console.log(e)});case 32:if(i){t.next=41;break}return d=n.driver.session(),console.log("MATCH p=(a{name:'"+n.queryA+"'})-[*.."+n.le+"]-(b{name:'"+n.queryB+"'}) UNWIND NODES(p) as n WITH DISTINCT n RETURN { id: id(n), label: n.name, property: properties(n), degree: size((n)--()) } as nodes"),t.next=37,d.run("MATCH p=(a{name:'"+n.queryA+"'})-[*.."+n.le+"]-(b{name:'"+n.queryB+"'}) UNWIND NODES(p) as n WITH DISTINCT n RETURN { id: id(n), label: n.name, property: properties(n), degree: size((n)--()) } as nodes").then(function(e){0===e.records.length?(n.$message.warning("这两个节点之间似乎没有什么关系呢~"),i=!0):u=e.records.map(function(e){var t=e.get("nodes");return t.id=t.id.toNumber(),t}),d.close()});case 37:if(i){t.next=41;break}return f=n.driver.session(),t.next=41,f.run("MATCH p=(a{name: '"+n.queryA+"'})-[*.."+n.le+"]-(b{name: '"+n.queryB+"'}) UNWIND relationships(p) as r WITH DISTINCT r RETURN r").then(function(e){h=e.records.map(function(e){var t=e.get("r");return{source:t.start.toNumber(),target:t.end.toNumber(),type:t.type}}),n.Graph(l).refresh(),n.Graph=Object(D.a)().height(n.height).width(n.width);var t={nodes:u,links:h};n.Graph(l).graphData(t).d3VelocityDecay(.75).nodeColor(function(e){return n.colorList[e.property.type]}).nodeLabel(function(e){return"description"in e.property?e.property.description:e.label}).nodeThreeObject(function(e){var t=new x.a(e.label);return t.material.depthWrite=!1,t.color=n.colorList[e.property.type],t.textHeight=n.sizeOnDegree(e),t}).nodeResolution(12).linkThreeObjectExtend(!0).linkThreeObject(function(e){var t=new x.a(""+e.type);return t.color=n.linkLabelColor,t.textHeight=2.5,t}).linkPositionUpdate(function(e,t){var n=t.start,r=t.end,o=v.a.apply(Object,y()(["x","y","z"].map(function(e){return m()({},e,n[e]+(r[e]-n[e])/2)})));v()(e.position,o)}).linkLabel(function(e){return e.type}).linkColor(n.linkColor).linkOpacity(.3).linkDirectionalParticles(1).linkDirectionalParticleColor(function(){return"red"}).linkDirectionalParticleSpeed(.02).linkDirectionalParticleWidth(1).linkDirectionalParticleResolution(8).onNodeHover(function(e){return l.style.cursor=e?"pointer":null}).onNodeClick(function(e){n.focusOnNode(e),e.fx=e.x,e.fy=e.y,e.fz=e.z}),n.Graph.onEngineStop(function(){return n.Graph.zoomToFit(400,10)}),f.close()});case 41:case"end":return t.stop()}},t,e)}))()},selectLog:function(e){console.log(e)},menuShow:function(e){this.showMenu=!this.showMenu;var t=0;this.showMenuItem.forEach(function(e){t+=e.show}),!this.showMenu&&t>0&&this.showMenuItem.map(function(e){e.show=!1}),this.showMenu||e.target.blur()},menuSelect:function(e){this.showMenuItem[e].show=!this.showMenuItem[e].show;var t=0;if(this.showMenuItem.forEach(function(e){t+=e.show}),t>1)for(var n=0;n<this.showMenuItem.length;n++)n!==e&&(this.showMenuItem[n].show=!1)},recolorNodes:function(){var e=this;e.Graph.nodeThreeObject(function(t){var n=new x.a(t.label);return n.material.depthWrite=!1,e.checkColorType.indexOf(t.property.type)>-1?n.color=e.colorList[t.property.type]:n.color=e.uncolored,n.textHeight=e.sizeOnDegree(t),n})},resetCamera:function(){this.Graph.zoomToFit(400,-20),this.$message({message:"相机已复位！",type:"success"})},resetCanvas:function(){var e=this,t=document.getElementById("3d-graph"),n={},r={},o=e.driver.session();o.run('MATCH (n)-[r]->(m) WHERE m.type <> "detail" RETURN { id: id(n), label: n.name, property: properties(n), degree: size((n)--()) } as source, { id: id(m), label: m.name, property: properties(m), degree: size((m)--()) } as target, type(r) as  relation').then(function(i){r=i.records.map(function(e){var t=e.get("source");t.id=t.id.toNumber(),n[t.id]=t;var r=e.get("target");return r.id=r.id.toNumber(),n[r.id]=r,{source:t.id,target:r.id,type:e.get("relation")}}),o.close();var a;e.Graph(t).refresh(),e.Graph=Object(D.a)().height(e.height).width(e.width),a={nodes:k()(n),links:r},e.Graph(t).graphData(a).d3VelocityDecay(.75).nodeColor(function(t){return e.colorList[t.property.type]}).nodeLabel(function(e){return"description"in e.property?e.property.description:e.label}).nodeThreeObject(function(t){var n=new x.a(t.label);return n.material.depthWrite=!1,n.color=e.colorList[t.property.type],n.textHeight=e.sizeOnDegree(t),n}).nodeResolution(12).linkThreeObjectExtend(!0).linkThreeObject(function(t){var n=new x.a(""+t.type);return n.color=e.linkLabelColor,n.textHeight=2.5,n}).linkPositionUpdate(function(e,t){var n=t.start,r=t.end,o=v.a.apply(Object,y()(["x","y","z"].map(function(e){return m()({},e,n[e]+(r[e]-n[e])/2)})));v()(e.position,o)}).linkLabel(function(e){return e.type}).linkColor(e.linkColor).linkOpacity(.3).linkDirectionalParticles(1).linkDirectionalParticleColor(function(){return"red"}).linkDirectionalParticleSpeed(.02).linkDirectionalParticleWidth(1).linkDirectionalParticleResolution(8).onNodeHover(function(e){return t.style.cursor=e?"pointer":null}).onNodeClick(function(t){var n=e.Graph.graphData();n.nodes,n.links;console.log(e.cacheDetail),e.cacheDetail.links.hasOwnProperty(t.id)&&e.cacheDetail.links[t.id].forEach(function(t){var n=e.Graph.graphData(),r=n.nodes,o=n.links,i=e.cacheDetail.nodes[t.target];e.Graph.graphData({nodes:[].concat(y()(r),[i]),links:[].concat(y()(o),[t])})}),e.focusOnNode(t),t.fx=t.x,t.fy=t.y,t.fz=t.z})}),e.$message({message:"画布已复原！",type:"success"})}}},S={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),e._v(" "),n("div",{staticClass:"el-menu",staticStyle:{position:"absolute","z-index":"3",top:"5%",left:"3%","background-color":"transparent","border-right":"transparent","align-items":"center"}},[n("el-row",{staticStyle:{"margin-bottom":"30%"}},[n("el-button",{attrs:{icon:"el-icon-menu",type:"danger",circle:""},on:{click:e.menuShow}})],1),e._v(" "),n("el-row",{staticStyle:{"margin-bottom":"30%","z-index":"3"}},[n("el-collapse-transition",[e.showMenu?n("el-button",{staticClass:"search-node-button",attrs:{icon:"el-icon-search",type:"danger",circle:""},on:{click:function(t){return e.menuSelect(0)}}}):e._e()],1)],1),e._v(" "),n("el-collapse-transition",[e.showMenuItem[0].show?n("div",{staticClass:"search-node-detail",staticStyle:{position:"absolute","z-index":"2",top:"17%","background-color":"transparent",left:"150%",width:"1000%","text-align":"left"}},[n("el-row",{staticStyle:{"margin-bottom":"0"}},[n("el-col",{attrs:{span:12}},[n("el-autocomplete",{staticStyle:{position:"relative"},attrs:{placeholder:"请输入查询节点","fetch-suggestions":e.querySearch,"trigger-on-focus":!1},model:{value:e.queryA,callback:function(t){e.queryA=t},expression:"queryA"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.queryForA(e.queryA)}},slot:"append"})],1)],1)],1)],1):e._e()]),e._v(" "),n("el-row",{staticStyle:{"margin-bottom":"30%"}},[n("el-collapse-transition",[n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showMenu,expression:"showMenu"}],staticClass:"ab-routine-button",attrs:{icon:"el-icon-share",type:"danger",circle:""},on:{click:function(t){return e.menuSelect(1)}}})],1)],1),e._v(" "),n("el-collapse-transition",[e.showMenuItem[1].show?n("div",{staticClass:"search-ab-detail",staticStyle:{position:"absolute","z-index":"2",top:"30%",left:"150%",width:"1000%","text-align":"left"}},[n("el-row",{staticStyle:{"margin-bottom":"0",alignment:"left"}},[n("el-col",{attrs:{span:8}},[n("el-autocomplete",{staticStyle:{position:"relative",width:"200%"},attrs:{placeholder:"请输入节点A","fetch-suggestions":e.querySearch,"trigger-on-focus":!1},on:{select:e.selectLog},model:{value:e.queryA,callback:function(t){e.queryA=t},expression:"queryA"}},[n("template",{slot:"prepend"},[e._v("A")])],2)],1)],1),e._v(" "),n("el-row",{staticStyle:{"margin-bottom":"0",alignment:"left"}},[n("el-col",{attrs:{span:8}},[n("el-collapse-transition",[n("el-autocomplete",{staticStyle:{position:"relative",width:"200%"},attrs:{placeholder:"请输入节点B","fetch-suggestions":e.querySearch,"trigger-on-focus":!1},on:{select:e.selectLog},model:{value:e.queryB,callback:function(t){e.queryB=t},expression:"queryB"}},[n("template",{slot:"prepend"},[e._v("B")]),e._v(" "),n("el-button",{staticClass:"button-find-AB",attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.queryForAB},slot:"append"})],2)],1)],1)],1)],1):e._e()]),e._v(" "),n("el-row",{staticStyle:{"margin-bottom":"30%"}},[n("el-collapse-transition",[n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showMenu,expression:"showMenu"}],staticClass:"recolor-button",attrs:{icon:"el-icon-view",type:"danger",circle:""},on:{click:function(t){return e.menuSelect(2)}}})],1)],1),e._v(" "),n("el-collapse-transition",[e.showMenuItem[2].show?n("div",{staticClass:"select-color-type",staticStyle:{position:"absolute","z-index":"2",top:"50%",left:"150%",width:"1000%","text-align":"left"}},[n("el-checkbox-group",{model:{value:e.checkColorType,callback:function(t){e.checkColorType=t},expression:"checkColorType"}},[n("el-checkbox-button",{attrs:{label:"paper",fill:"#DB515B"},on:{change:e.recolorNodes}},[e._v("Paper")]),e._v(" "),n("el-checkbox-button",{attrs:{label:"metric",fill:"#DB515B"},on:{change:e.recolorNodes}},[e._v("Metric")]),e._v(" "),n("el-checkbox-button",{attrs:{label:"baseline",fill:"#DB515B"},on:{change:e.recolorNodes}},[e._v("Baseline")])],1)],1):e._e()]),e._v(" "),n("el-row",{staticStyle:{"margin-bottom":"30%"}},[n("el-collapse-transition",[n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showMenu,expression:"showMenu"}],staticClass:"reset-camera-button",attrs:{icon:"el-icon-location-outline",type:"danger",circle:""},on:{click:e.resetCamera}})],1)],1),e._v(" "),n("el-row",{staticStyle:{"margin-bottom":"30%"}},[n("el-collapse-transition",[n("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showMenu,expression:"showMenu"}],staticClass:"reset-canvas-button",attrs:{icon:"el-icon-refresh",type:"danger",circle:""},on:{click:e.resetCanvas}})],1)],1)],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container",staticStyle:{position:"absolute",height:"95%",width:"98%",left:"1%","z-index":"0",border:"1px solid #CCCCCC","border-radius":"8px",overflow:"hidden"}},[t("div",{staticStyle:{"z-index":"0"},attrs:{id:"3d-graph"}})])}]};var z=n("VU/8")(E,S,!1,function(e){n("eKlW")},null,null).exports;r.default.use(a.a);var q=new a.a({routes:[{path:"/",name:"Canvas",component:z}]});r.default.config.productionTip=!1,new r.default({el:"#app",router:q,components:{App:i},template:"<App/>"})},eKlW:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.b76b2d12e77319437f8e.js.map